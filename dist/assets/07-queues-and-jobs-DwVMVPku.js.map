{"version":3,"file":"07-queues-and-jobs-DwVMVPku.js","sources":["../../pages/07-queues-and-jobs.md"],"sourcesContent":["# 07 – Queues & Jobs\r\n\r\n## Queue Configuration\r\n\r\n- **Driver**: `database` (default)\r\n- **Table**: `jobs`\r\n- **Worker**: `php artisan queue:work database --timeout=600 --tries=3 --memory=512 --sleep=3`\r\n\r\n## Job Classes\r\n\r\n| Job | Timeout | Tries | Purpose |\r\n|-----|---------|-------|---------|\r\n| `ProcessAudioJob` | 600s | 3 | Full pipeline: transcribe → translate → TTS |\r\n| `ProcessAudioTTSJob` | 600s | 3 | TTS only for audio file |\r\n| `ProcessTextToAudioJob` | 600s | 3 | Text-to-audio |\r\n| `ProcessCsvTranslationJob` | 7200s | 3 | CSV/XLSX translation (large files) |\r\n| `ProcessAdditionalAudioTranslation` | 600s | 3 | Additional translations |\r\n| `ProcessAudioTranslationJob` | 600s | 3 | Audio translation variant |\r\n\r\n## Why 600s Timeout?\r\n\r\n- TTS can be slow (180s HTTP timeout per request)\r\n- Multiple retries possible\r\n- Job must not be killed before HTTP request completes\r\n\r\n## Running the Worker\r\n\r\n**Local (with composer):**\r\n\r\n```bash\r\ncomposer run dev:full\r\n```\r\n\r\n**Production (supervisor/systemd):**\r\n\r\n```bash\r\nphp artisan queue:work database --timeout=600 --tries=3 --memory=512 --sleep=3\r\n```\r\n\r\n**Important**: Worker `--timeout` must be ≥ job timeout (600). Otherwise the worker kills the process before the job finishes.\r\n\r\n## Failed Jobs\r\n\r\n- Failed jobs are logged via `failed()` method on each job\r\n- Check `storage/logs/laravel.log`\r\n- Use `php artisan queue:failed` to list failed jobs\r\n- Use `php artisan queue:retry all` to retry\r\n"],"names":["_jsx","_components"],"mappings":"8wBAAE,SAAA;uCAEC,SAAA;;yCAEC,SAAA,QAAQ,CAAA,EAAA,KAAAA,MAAAC,EAAA,KAAA,eAAE,SAAA,UAAU,CAAA,EAAA,YAAA;yCACpB,SAAA,OAAO,CAAA,EAAA,KAAAD,MAAAC,EAAA,KAAA,eAAE,SAAA;yCACT,SAAA,QAAQ,CAAA,EAAA,KAAAD,MAAAC,EAAA,KAAA,eAAE,SAAA;;+BAEX,SAAA;uFAED,SAAA,oBAAM,SAAA,wBAAU,SAAA,sBAAQ,SAAA,mHAExB,SAAA,kCAAoB,SAAA,qBAAO,SAAA,kBAAI,SAAA,2HAC/B,SAAA,qCAAuB,SAAA,qBAAO,SAAA,kBAAI,SAAA,uGAClC,SAAA,wCAA0B,SAAA,qBAAO,SAAA,kBAAI,SAAA,6FACrC,SAAA,2CAA6B,SAAA,sBAAQ,SAAA,kBAAI,SAAA,kHACzC,SAAA,oDAAsC,SAAA,qBAAO,SAAA,kBAAI,SAAA,uGACjD,SAAA,6CAA+B,SAAA,qBAAO,SAAA,kBAAI,SAAA;oCAEzC,SAAA;;cAED,SAAA;cACA,SAAA;cACA,SAAA;;sCAEC,SAAA;sCAED,SAAA;;sCAMA,SAAA;;wCAMA,SAAA,WAAW,CAAA,EAAA,YAAAD,MAAAC,EAAA,KAAA,eAAS,SAAA,WAAW,CAAA,EAAA,+FAAA;+BAE9B,SAAA;;eAED,SAAA,CAAA,8BAAAD,MAAAC,EAAA,KAAA,eAA2B,SAAA,UAAU,CAAA,EAAA,qBAAA;eACrC,SAAA,CAAA,SAAAD,MAAAC,EAAA,KAAA,eAAM,SAAA;eACN,SAAA,CAAA,OAAAD,MAAAC,EAAA,KAAA,eAAI,SAAA,0BAA0B,CAAA,EAAA,sBAAA;eAC9B,SAAA,CAAA,OAAAD,MAAAC,EAAA,KAAA,eAAI,SAAA,6BAA6B,CAAA,EAAA,WAAA;"}