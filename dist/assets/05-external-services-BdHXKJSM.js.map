{"version":3,"file":"05-external-services-BdHXKJSM.js","sources":["../../pages/05-external-services.md"],"sourcesContent":["# 05 – External Services\r\n\r\n## Google Cloud\r\n\r\n### APIs Used\r\n\r\n| API | Endpoint | Purpose |\r\n|-----|----------|---------|\r\n| Cloud Translation API | `translation.googleapis.com/v3` | Translation, language detection |\r\n| Cloud Text-to-Speech API | `texttospeech.googleapis.com/v1/text:synthesize` | Gemini 2.5 Pro TTS |\r\n| Vertex AI API | - | Must be enabled for Gemini TTS |\r\n\r\n### Authentication\r\n\r\n- **Service account** (JSON key file or base64 in env)\r\n- **OAuth2**: JWT created from service account, exchanged for access token\r\n- Token cached in Laravel cache (`gemini_oauth_access_token`)\r\n\r\n### Required IAM Roles\r\n\r\n- **Cloud Translation API User** (`roles/cloudtranslate.user`)\r\n- **Cloud Text-to-Speech User** (`roles/texttospeech.user`)\r\n- **Service Usage Consumer** (`roles/serviceusage.serviceUsageConsumer`)\r\n\r\n### Credentials Location\r\n\r\n- Default: `storage/app/google-service-account.json`\r\n- Or: `GOOGLE_SERVICE_ACCOUNT_JSON` (base64) in `.env`\r\n- Or: `GOOGLE_SERVICE_ACCOUNT_PATH` (custom path) in `.env`\r\n\r\n---\r\n\r\n## OpenAI\r\n\r\n### APIs Used\r\n\r\n| API | Purpose |\r\n|-----|---------|\r\n| Whisper | Audio transcription |\r\n| TTS (optional) | Fallback if Gemini fails (SimpleTtsService) |\r\n\r\n### Configuration\r\n\r\n- `OPENAI_API_KEY` in `.env`\r\n- `config/openai.php`\r\n\r\n---\r\n\r\n## Stripe\r\n\r\n### Usage\r\n\r\n- Checkout session for credit packages\r\n- Webhook updates user credits on successful payment\r\n- Webhook route: `POST /webhook/stripe` (no auth, rate limited)\r\n\r\n### Configuration\r\n\r\n- `STRIPE_KEY`, `STRIPE_SECRET`, `STRIPE_WEBHOOK_SECRET`\r\n- `STRIPE_STARTER_PRICE_ID` for credit package\r\n- `config/stripe.php` – credit packages, default cost per translation\r\n"],"names":["_jsx","_components"],"mappings":"+gCAAE,SAAA;gCAEC,SAAA;6BAEC,SAAA;uFAEF,SAAA,oBAAM,SAAA,yBAAW,SAAA,8EAEjB,SAAA,2EAAwB,SAAA,gDAAkC,SAAA,0EAC1D,SAAA,8EAA2B,SAAA,iEAAmD,SAAA,6DAC9E,SAAA,8BAAgB,SAAA,kBAAI,SAAA;kCAElB,SAAA;;yCAEA,SAAA,iBAAiB,CAAA,EAAA,mCAAA;yCACjB,SAAA,QAAQ,CAAA,EAAA,gEAAA;eACV,SAAA,CAAA,kCAAAA,MAAAC,EAAA,KAAA,eAA+B,SAAA,2BAA2B,CAAA,EAAA,GAAA;;sCAExD,SAAA;;yCAEA,SAAA,4BAA4B,CAAA,EAAA,KAAAD,MAAAC,EAAA,KAAA,eAAE,SAAA,2BAA2B,CAAA,EAAA,GAAA;yCACzD,SAAA,2BAA2B,CAAA,EAAA,KAAAD,MAAAC,EAAA,KAAA,eAAE,SAAA,yBAAyB,CAAA,EAAA,GAAA;yCACtD,SAAA,wBAAwB,CAAA,EAAA,KAAAD,MAAAC,EAAA,KAAA,eAAE,SAAA,yCAAyC,CAAA,EAAA,GAAA;;wCAEnE,SAAA;;eAEF,SAAA,CAAA,YAAAD,MAAAC,EAAA,KAAA,eAAS,SAAA;eACT,SAAA,CAAA,OAAAD,MAAAC,EAAA,KAAA,eAAI,SAAA,6BAA6B,CAAA,EAAA,gBAAAD,MAAAC,EAAA,KAAA,eAAa,SAAA;eAC9C,SAAA,CAAA,OAAAD,MAAAC,EAAA,KAAA,eAAI,SAAA,6BAA6B,CAAA,EAAA,qBAAAD,MAAAC,EAAA,KAAA,eAAkB,SAAA;;;0BAIlD,SAAA;+BAEC,SAAA;uFAEF,SAAA,oBAAM,SAAA,8EAEN,SAAA,wBAAU,SAAA,8DACV,SAAA,+BAAiB,SAAA;iCAEf,SAAA;;qDAEF,SAAA,gBAAgB,CAAA,EAAA,OAAAD,MAAAC,EAAA,KAAA,eAAI,SAAA;mDACpB,SAAA;;;0BAIC,SAAA;yBAEC,SAAA;;cAEF,SAAA;cACA,SAAA;eACA,SAAA,CAAA,kBAAAD,MAAAC,EAAA,KAAA,eAAe,SAAA,sBAAsB,CAAA,EAAA,0BAAA;;mCAEnC,SAAA;;qDAEF,SAAA,YAAY,CAAA,EAAA,KAAAD,MAAAC,EAAA,KAAA,eAAE,SAAA,eAAe,CAAA,EAAA,KAAAD,MAAAC,EAAA,KAAA,eAAE,SAAA;qDAC/B,SAAA,yBAAyB,CAAA,EAAA,qBAAA;qDACzB,SAAA,mBAAmB,CAAA,EAAA,kDAAA;"}